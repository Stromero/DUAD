CREATE TABLE Customers(
id INTEGER PRIMARY KEY,
name VARCHAR(25),
email VARCHAR(25)
);

CREATE TABLE Authors(
id INTEGER PRIMARY KEY,
name VARCHAR(25)
);

CREATE TABLE Books(
id INTEGER PRIMARY KEY,
name VARCHAR(25),
id_author REFERENCES Authors(id) DEFAULT NULL
);

CREATE TABLE Rents(
id INTEGER PRIMARY KEY,
id_book REFERENCES Books(id),
id_customer REFERENCES Authors(id),
state VARCHAR(25)
);

INSERT INTO Authors (id,name) VALUES 
(1,'Miguel de Cervantes');
INSERT INTO Authors (id,name) VALUES
(2,'Dante Alighieri');
INSERT INTO Authors (id,name) VALUES
(3,'Takehiko Inoue');
INSERT INTO Authors (id,name) VALUES
(4,'Akira Toriyama');
INSERT INTO Authors (id,name) VALUES
(5,'Walt Disney');

INSERT INTO Books (id,name,id_author) VALUES 
(1,'Don Quijote',1);
INSERT INTO Books (id,name, id_author) VALUES
(2,'La Divina Comedia',2);
INSERT INTO Books (id,name,id_author) VALUES
(3,'Vagabond 1-3',3);
INSERT INTO Books (id,name,id_author) VALUES
(4,'Dragon Ball 1',4);
INSERT INTO Books (id,name,id_author) VALUES
(5,'The Book of the 5 Rings');

INSERT INTO Customers (id,name,email) VALUES
(1,'John Doe','j.doe@email.com');
INSERT INTO Customers (id,name,email) VALUES
(2,'Jane Doe','jane@doe.com');
INSERT INTO Customers (id,name,email) VALUES
(3,'Luke Skywalker','darth.son@email.com');

INSERT INTO Rents (id,id_book,id_customer,state) VALUES
(1,1,2,'Returned');
INSERT INTO Rents (id,id_book,id_customer,state) VALUES
(2,2,2,'Returned');
INSERT INTO Rents (id,id_book,id_customer,state) VALUES
(3,1,1,'On time');
INSERT INTO Rents (id,id_book,id_customer,state) VALUES
(4,3,1,'On time');
INSERT INTO Rents (id,id_book,id_customer,state) VALUES
(5,2,2,'Overdue');


SELECT Books.name, Authors.name
from Books as books
INNER JOIN Authors as authors
on Books.id_author = Authors.id

SELECT *
FROM Books 
where id_author IS NULL

SELECT a.*
FROM Authors a 
LEFT JOIN Books b on a.id = b.id_author
WHERE b.id_author IS NULL

SELECT Books.name
from Books
INNER JOIN Rents on Books.id = Rents.id_book

SELECT books.*
from Books books
LEFT JOIN Rents rents on books.id = rents.id_book
WHERE rents.id_book IS NULL

SELECT cliente.name
from Customers cliente
LEFT JOIN Rents rents on cliente.id = rents.id_customer
WHERE rents.id_customer IS NULL




